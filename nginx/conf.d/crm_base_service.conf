server
{
    # 第一个参数：zone=one 设置使用哪个配置区域来做限制，与上面limit_req_zone 里的name对应
    # 第二个参数：burst=5，重点说明一下这个配置，burst爆发的意思，这个配置的意思是设置一个大小为5的缓冲区当有大量请求（爆发）过来时，超过了访问频次限制的请求可以先放到这个缓冲区内
    # 第三个参数：nodelay，如果设置，超过访问频次而且缓冲区也满了的时候就会直接返回503，如果没有设置，则所有请求会等待排队
	#limit_req zone=one burst=1 nodelay;
    # server 并发连接限制
	#limit_conn addr 10;
    listen                  80;
    server_name             dev.test.crm_base_service.com;
    root                    /var/www/crm_base_service/public/;
    index                   index.php index.html;
    
    access_log /var/log/nginx/crm_base_service-access.log;
    error_log /var/log/nginx/crm_base_service-error.log;
    # 缓存
    #location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|mp4)$ {
        #expires      30d;
    #}
    
	# location ~ .*\.(js|css)?$ {
        #expires      12h;
    # }

	location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location ~ \.php$ {
        fastcgi_pass   dk-php:9000;
        fastcgi_index  index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
		fastcgi_param PHP_VALUE "error_log=/var/log/nginx/application_php_errors.log";
		fastcgi_buffers 16 16k;
		fastcgi_buffer_size 32k;
		include fastcgi_params;
    }
    location /favicon.ico {
        log_not_found off;
    }


}
